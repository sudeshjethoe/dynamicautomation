---
title: Configuring NFS on Fonera 2.0n
date: '2012-01-06 02:08:11 +0100'
categories:
- blog
tags:
- linux
- fon
- nfs
---
<p>1. Install nfs: 'opkg install unfs3'<br />
2:Edit hosts.deny:<br />
echo 'ALL: ALL' > /etc/hosts.deny<br />
3:Edit hosts.allow:<br />
echo '192.168.1.' > /etc/hosts.allow<br />
4:Edit /etc/exports (with vi and enter):<br />
/tmp/mounts/Disc-A1/music (ro,async,insecure,root_squash,proto=udp,anonuid=65534,anongid=65534)<br />
/tmp/mounts/Disc-A1/videos (ro,async,insecure,root_squash,proto=udp,anonuid=65534,anongid=65534)<br />
/tmp/mounts/Disc-A1/pictures (ro,async,insecure,root_squash,proto=udp,anonuid=65534,anongid=65534)<br />
/tmp/mounts/Disc-A1/my_home (rw,sync,secure,root_squash,proto=tcp,anonuid=65534,anongid=65534)</p>
<p>5: Start service:<br />
/etc/init.d/portmap start &amp;&amp; sleep 3 &amp;&amp; /etc/init.d/unfs3 start</p>
<p>6: Enable on reboot:<br />
/etc/init.d/portmap enable &amp;&amp; /etc/init.d/unfs3 enable</p>
<p>Explain:<br />
allow > deny<br />
ro: read only<br />
async: unsafe, no file locking but faster<br />
insecure: allow ports over 1024 to connect<br />
root_squash: remote root is converted to anonuid+anongid<br />
anonuid: server uid of anonymous user<br />
anongid: server gid of anonymous user</p>
<p>uid's and gid's are mapped one to one (possible security risk)</p>
<p>*http://wiki.fon.com/wiki/F2_NFS</p>
<p>Now for pure awesomeness enable automount* on your client:<br />
Easy as: 'yum install autofs'<br />
And add the following too</p>
<blockquote><p>/etc/auto.misc >>:<br />
# local entries<br />
fon-svjethoe -fstype=nfs,rw,tcp,rsize=32768,wsize=32768 fonera:/tmp/mounts/Disc-A1/svjethoe<br />
fon-music -fstype=nfs,rsize=32768,wsize=32768 :/tmp/mounts/Disc-A1/music<br />
fon-pictures -fstype=nfs,rsize=32768,wsize=32768 :/tmp/mounts/Disc-A1/pictures<br />
fon-videos -fstype=nfs,rsize=32768,wsize=32768 :/tmp/mounts/Disc-A1/videos</p>
<p># vpn entries<br />
fon-svjethoe -fstype=nfs,rw,tcp,rsize=32768,wsize=32768 10.8.0.1:/tmp/mounts/Disc-A1/svjethoe<br />
fon-music -fstype=nfs,rsize=32768,wsize=32768 :/tmp/mounts/Disc-A1/music<br />
fon-pictures -fstype=nfs,rsize=32768,wsize=32768 :/tmp/mounts/Disc-A1/pictures<br />
fon-videos -fstype=nfs,rsize=32768,wsize=32768 :/tmp/mounts/Disc-A1/videos</p></blockquote>
<p>Now the folders will be automatically mounted when accessed (defaults under /misc ->)<br />
rsize= transfer block size for reads in bytes (=32bytes=max=nfs4 default)<br />
wsize= transfer block size for writes in bytes ( "" """" "")<br />
default rsize+wsize in nfs3= 8 bytes</p>
<p>Just run 'cd /misc/fon-music' and you're there!</p>
<p>http://fedoraproject.org/wiki/Administration_Guide_Draft/NFS</p>
